# LLavaæ¶æ„DIY

## LLavaç»„è£…
ç¬¬ä¸€æ­¥ä¿å­˜ç»„è£…æ¨¡å‹ï¼šbuild_model_show.ipynb
å…¶ä¸­çš„çº¿æ€§å±‚æ˜¯éšæœºåˆå§‹åŒ–ï¼Œå› æ­¤æµ‹è¯•VQAæ•ˆæœå¾ˆå·®ï¼Œè¿™ä¹Ÿæ˜¯æ­£å¸¸çš„ï½ï½
### è§†è§‰å±‚
è§†è§‰å±‚é€‰å–**openai/clip-vit-large-patch14-336**
### è¯­è¨€å±‚
è¯­è¨€å±‚é€‰å–**Qwen1.5-4B-Chat**

## æ•°æ®æ„å»º
### æ•°æ®é›†
liuhaotian/LLaVA-CC3M-Pretrain-595K
ä¸‹è½½åå¯è¿›è¡Œè§£å‹ç¼©ï¼ŒæŸ¥çœ‹å›¾ç‰‡
```bash
unzip -d images_dl images.zip
```
### æ•°æ®é›†æ„å»º
æ•°æ®æµè§ˆå¯è§ï¼šmake_dataset.ipynb
Datasetæ„å»ºå¯è§train_llavaæ–‡ä»¶å¤¹

## è®­ç»ƒ
### è®­ç»ƒæ–¹å¼
åŸºäºdeepspeed-zero2ï¼Œæœ‰loraè®­ç»ƒã€å…¨é‡å‚æ•°è®­ç»ƒã€å†»ç»“è§†è§‰å±‚è¿›è¡Œè®­ç»ƒç­‰æ–¹å¼ã€‚
### è®­ç»ƒç­–ç•¥

| è®­ç»ƒæ–¹å¼                         | è§†è§‰å±‚  | è½¬æ¥å±‚  | è¯­è¨€å±‚        | æ•ˆæœè¯„ä¼°     |
|------------------------------|------|------|------------|----------|
| `--train_type use_lora`      | å†»ç»“ğŸ§Š | è®­ç»ƒğŸ”¥ | è®­ç»ƒğŸ”¥ï¼ˆéƒ¨åˆ†å‚æ•°ï¼‰ | æ•ˆæœéå¸¸å¥½ ğŸ‘ |
| `--train_type none`          | è®­ç»ƒğŸ”¥ | è®­ç»ƒğŸ”¥ | è®­ç»ƒğŸ”¥       | æ•ˆæœéå¸¸å·®ğŸ‘  |
| `--train_type freeze_vision` | å†»ç»“ğŸ§Š | è®­ç»ƒğŸ”¥ | è®­ç»ƒğŸ”¥ï¼ˆå…¨é‡å‚æ•°  | å°šæœªè¯„ä¼°     |

1. è®­ç»ƒçš„æ—¶å€™ï¼Œä½¿ç”¨loraæ–¹å¼è¿›è¡Œè®­ç»ƒæœ€å¥½ã€‚åœ¨`run_zero2.sh`é‡Œé¢è®¾ç½®`--train_type use_lora`å³å¯ã€‚
2. å…¨é‡å‚æ•°è®­ç»ƒï¼Œæ•ˆæœéå¸¸å·®ã€‚
### å¯åŠ¨
```bash
bash run_zero2.py
```
### æŸ¥çœ‹æ—¥å¿—
```bash
tail -f llava_train_0712.log
```

## æ¨ç†
æ¨ç†å¯è§ï¼šllava_infer_lora.ipynb